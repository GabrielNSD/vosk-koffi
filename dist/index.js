"use strict";var h=Object.create;var l=Object.defineProperty;var w=Object.getOwnPropertyDescriptor;var R=Object.getOwnPropertyNames;var V=Object.getPrototypeOf,b=Object.prototype.hasOwnProperty;var y=(r,e)=>{for(var n in e)l(r,n,{get:e[n],enumerable:!0})},p=(r,e,n,t)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of R(e))!b.call(r,i)&&i!==n&&l(r,i,{get:()=>e[i],enumerable:!(t=w(e,i))||t.enumerable});return r};var m=(r,e,n)=>(n=r!=null?h(V(r)):{},p(e||!r||!r.__esModule?l(n,"default",{value:r,enumerable:!0}):n,r)),M=r=>p(l({},"__esModule",{value:!0}),r);var P={};y(P,{Model:()=>k,Recognizer:()=>g,SpeakerModel:()=>d,default:()=>x,setLogLevel:()=>z});module.exports=M(P);var v=m(require("os")),_=m(require("path")),a=m(require("koffi"));a.default.opaque("VoskModel");a.default.opaque("VoskSpkModel");a.default.opaque("VoskRecognizer");var c;if(v.default.platform()=="win32"){let r=process.env.Path,e=_.default.resolve(_.default.join(__dirname,"../lib","win-x86_64"));process.env.Path=e+_.default.delimiter+r,c=_.default.join(__dirname,"../lib","win-x86_64","libvosk.dll")}else v.default.platform()=="darwin"?c=_.default.join(__dirname,"../lib","osx-universal","libvosk.dylib"):c=_.default.join(__dirname,"../lib","linux-x86_64","libvosk.so");var s=a.default.load(c),o={vosk_set_log_level:s.func("void vosk_set_log_level(int log_level)"),vosk_model_new:s.func("VoskModel *vosk_model_new(const char *model_path)"),vosk_model_free:s.func("void vosk_model_free(VoskModel *model)"),vosk_spk_model_new:s.func("VoskSpkModel *vosk_spk_model_new(const char *model_path)"),vosk_spk_model_free:s.func("void vosk_spk_model_free(VoskSpkModel *model)"),vosk_recognizer_new_spk:s.func("VoskRecognizer *vosk_recognizer_new_spk(VoskModel *model, float sample_rate, VoskSpkModel *spk_model)"),vosk_recognizer_new:s.func("VoskRecognizer *vosk_recognizer_new(VoskModel *model, float sample_rate)"),vosk_recognizer_new_grm:s.func("VoskRecognizer *vosk_recognizer_new_grm(VoskModel *model, float sample_rate, const char *grammar)"),vosk_recognizer_free:s.func("void vosk_recognizer_free(VoskRecognizer *recognizer)"),vosk_recognizer_set_max_alternatives:s.func("void vosk_recognizer_set_max_alternatives(VoskRecognizer *recognizer, int max_alternatives)"),vosk_recognizer_set_words:s.func("void vosk_recognizer_set_words(VoskRecognizer *recognizer, int words)"),vosk_recognizer_set_partial_words:s.func("void vosk_recognizer_set_partial_words(VoskRecognizer *recognizer, int partial_words)"),vosk_recognizer_set_spk_model:s.func("void vosk_recognizer_set_spk_model(VoskRecognizer *recognizer, VoskSpkModel *spk_model)"),vosk_recognizer_accept_waveform:s.func("int vosk_recognizer_accept_waveform(VoskRecognizer *recognizer, const char *data, int length)"),vosk_recognizer_result:s.func("const char *vosk_recognizer_result(VoskRecognizer *recognizer)"),vosk_recognizer_final_result:s.func("const char *vosk_recognizer_final_result(VoskRecognizer *recognizer)"),vosk_recognizer_partial_result:s.func("const char *vosk_recognizer_partial_result(VoskRecognizer *recognizer)"),vosk_recognizer_reset:s.func("void vosk_recognizer_reset(VoskRecognizer *recognizer)")};function z(r){o.vosk_set_log_level(r)}var k=class{constructor(e){this.handle=o.vosk_model_new(e)}free(){o.vosk_model_free(this.handle)}},d=class{constructor(e){this.handle=o.vosk_spk_model_new(e)}free(){o.vosk_spk_model_free(this.handle)}};function u(r,e){return r.hasOwnProperty(e)}var g=class{constructor(e){let{model:n,sampleRate:t}=e;if(u(e,"speakerModel")&&u(e,"grammar"))throw new Error("grammar and speakerModel cannot be used together for now.");this.handle=e.speakerModel?o.vosk_recognizer_new_spk(n.handle,t,e.speakerModel.handle):e.grammar?o.vosk_recognizer_new_grm(n.handle,t,JSON.stringify(e.grammar)):o.vosk_recognizer_new(n.handle,t)}free(){o.vosk_recognizer_free(this.handle)}setMaxAlternatives(e){o.vosk_recognizer_set_max_alternatives(this.handle,e)}setWords(e){o.vosk_recognizer_set_words(this.handle,Number(e))}setPartialWords(e){o.vosk_recognizer_set_partial_words(this.handle,Number(e))}setSpkModel(e){o.vosk_recognizer_set_spk_model(this.handle,e.handle)}acceptWaveform(e){return!!o.vosk_recognizer_accept_waveform(this.handle,e,e.length)}acceptWaveformAsync(e){return new Promise((n,t)=>{o.vosk_recognizer_accept_waveform.async(this.handle,e,e.length,function(i,f){i?t(i):n(!!f)})})}resultString(){return o.vosk_recognizer_result(this.handle)}result(){return JSON.parse(o.vosk_recognizer_result(this.handle))}partialResult(){return JSON.parse(o.vosk_recognizer_partial_result(this.handle))}finalResult(){return JSON.parse(o.vosk_recognizer_final_result(this.handle))}reset(){o.vosk_recognizer_reset(this.handle)}},x={setLogLevel:z,Model:k,SpeakerModel:d,Recognizer:g};0&&(module.exports={Model,Recognizer,SpeakerModel,setLogLevel});
